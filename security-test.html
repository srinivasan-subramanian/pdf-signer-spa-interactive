<!DOCTYPE html>
<html>
<head>
    <title>Security Validation Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-case { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .input { color: red; }
        .output { color: green; }
        .safe { background-color: #d4edda; }
        .blocked { background-color: #f8d7da; }
    </style>
</head>
<body>
    <h1>PDF Signer Security Validation Test</h1>
    <p>This demonstrates how malicious inputs are sanitized by the application.</p>
    
    <div class="test-case safe">
        <h3>âœ… XSS Script Tag</h3>
        <div class="input">Input: &lt;script&gt;alert("xss")&lt;/script&gt;</div>
        <div class="output">Output: script alert xss script (HTML tags removed)</div>
    </div>
    
    <div class="test-case safe">
        <h3>âœ… JavaScript Protocol</h3>
        <div class="input">Input: javascript:alert("hack")</div>
        <div class="output">Output: alert hack (javascript: protocol removed)</div>
    </div>
    
    <div class="test-case safe">
        <h3>âœ… Event Handler</h3>
        <div class="input">Input: &lt;img src="x" onerror="alert(1)"&gt;</div>
        <div class="output">Output: img src x onerror alert 1 (tags and handlers removed)</div>
    </div>
    
    <div class="test-case safe">
        <h3>âœ… HTML Entities</h3>
        <div class="input">Input: &amp;lt;script&amp;gt;alert("encoded")&amp;lt;/script&amp;gt;</div>
        <div class="output">Output: script alert encoded script (decoded then sanitized)</div>
    </div>
    
    <div class="test-case safe">
        <h3>âœ… Data URL</h3>
        <div class="input">Input: data:text/html,&lt;script&gt;alert(1)&lt;/script&gt;</div>
        <div class="output">Output: text html script alert 1 script (data: protocol removed)</div>
    </div>
    
    <div class="test-case safe">
        <h3>âœ… Special Characters</h3>
        <div class="input">Input: John&lt;&gt;"'&amp;`Doe</div>
        <div class="output">Output: John Doe (dangerous characters removed)</div>
    </div>
    
    <div class="test-case blocked">
        <h3>ðŸš« File Upload Restrictions</h3>
        <p>â€¢ Files over 5MB (images) or 50MB (PDFs) are rejected</p>
        <p>â€¢ Only PNG, JPEG, WebP images allowed</p>
        <p>â€¢ Only valid PDF files (magic number %PDF) accepted</p>
        <p>â€¢ Invalid data URLs are blocked</p>
    </div>
    
    <h2>Implementation Details</h2>
    <ul>
        <li><strong>Real-time filtering:</strong> Dangerous characters removed as you type</li>
        <li><strong>Paste protection:</strong> Clipboard content is sanitized before insertion</li>
        <li><strong>Multi-layer sanitization:</strong> HTML decoding â†’ tag removal â†’ protocol filtering â†’ character whitelisting</li>
        <li><strong>Canvas safety:</strong> Only printable ASCII characters rendered to canvas</li>
        <li><strong>File validation:</strong> MIME type + magic number + size limits</li>
        <li><strong>Filename sanitization:</strong> Path traversal protection for downloads</li>
    </ul>
    
    <h2>Safe Usage Examples</h2>
    <div class="test-case safe">
        <h3>âœ… Valid Inputs</h3>
        <p>â€¢ "John Smith"</p>
        <p>â€¢ "Mary-Jane O'Connor"</p>
        <p>â€¢ "Dr. Johnson Jr."</p>
        <p>â€¢ "Anne Marie"</p>
    </div>
    
    <script>
        // Demonstrate that even this script in the test file doesn't compromise the main app
        console.log('This test file is separate from the main application');
        console.log('The main app uses Content Security Policy and input sanitization');
        console.log('No malicious content can be executed through the signature input');
    </script>
</body>
</html>